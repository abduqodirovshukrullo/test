import{bb as E,bc as v,k as w,D as P,o as g,c as L,p as e,w as t,m as o,A as R,q as _,b4 as Q,b1 as G,bh as H,z as c,x as u,b as x,a$ as O,bj as J,aP as N,b7 as K}from"./index.ccf75e8b.js";import{_ as W}from"./DataTable.632e8001.js";import{a as A}from"./axios.6988005b.js";import{u as $}from"./coreInspectionInfos.28e53fe3.js";import{u as B}from"./coreInspectorInfos.343b3646.js";import"./clientApplicationStore.3a226169.js";import{u as F}from"./systemUserStore.da0c3aeb.js";import{V as X}from"./VSpacer.3dae3a1a.js";import{V}from"./VBtn.51511430.js";import{V as Y,a as f,b as m}from"./VList.195d91c9.js";import{V as y}from"./VChip.6d62dc6b.js";import{V as Z}from"./VDivider.82c53423.js";import{V as ee}from"./VForm.39e46bcf.js";import{V as te,a as j}from"./VRow.126a71fb.js";import{V as ae}from"./VNavigationDrawer.cd147b40.js";import"./index.d79d6c26.js";import"./form.66042bc2.js";import"./ssrBoot.9c630877.js";const T=E("UserApplication",{state:()=>({pagination:{meta:{}},filter:{},userApplications:[],userApplication:{type:"",passport_serial:"",pin:"",phone:"",inspection_id:"",appeal_text:"",document_url:"",user_id:"",status:1,order:null},loading:!1,error:""}),actions:{fetchUserApplications(l){return this.loading=!0,l={...{page:this.pagination.meta.current_page,per_page:this.pagination.meta.per_page},...l},new Promise((a,s)=>{A.get("dashboard/user/application",{params:l}).then(n=>{this.userApplications=n.data.result,this.pagination.meta=n.data.result.meta,a(n)}).catch(n=>{this.error=n,s(n)}).finally(()=>{this.loading=!1})})},fetchUserApplication(l){return new Promise((i,a)=>{A.get(`dashboard/user/application/${l}`).then(s=>{this.userApplication=s.data.result,i(s.data.result)}).catch(s=>{this.error=s,a(s)}).finally(()=>{this.loading=!1})})},addUserApplication(l){return this.loading=!0,new Promise((i,a)=>{A.post("dashboard/user/application",l,{headers:{"Content-Type":"multipart/form-data"}}).then(s=>i(s)).catch(s=>{this.error=s,a(s)}).finally(()=>{this.loading=!1})})},updateUserApplication(l,i){return this.loading=!0,new Promise((a,s)=>{A.post("dashboard/user/application/"+l+"?_method=PUT",i,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>a(n)).catch(n=>{this.error=n,s(n)}).finally(()=>{this.loading=!1})})},deleteUserApplication(l){return this.loading=!0,new Promise((i,a)=>{A.delete("dashboard/user/application/"+l).then(s=>i(s)).catch(s=>{this.error=s,a(s)}).finally(()=>{this.loading=!1})})}}}),se={class:"d-flex align-center pa-6 pb-1"},ie=o("h6",{class:"text-h6"}," Info details ",-1),oe={class:"text-base font-weight-semibold"},le={class:"text-body-2"},ne={class:"text-base font-weight-semibold"},re={class:"text-body-2"},pe={class:"text-base font-weight-semibold"},ce={class:"text-body-2"},ue=o("h6",{class:"text-base font-weight-semibold"}," Text: ",-1),de={class:"text-body-2"},fe=o("h6",{class:"text-base font-weight-semibold"}," Inspection name: ",-1),me={class:"text-base font-weight-semibold"},_e={class:"text-body-2"},he={class:"text-base font-weight-semibold"},be={__name:"ApplicationInfo",props:{isInfoDrawerOpened:{default:null,required:!0},coreInspections:{type:Object},userApplicationDetails:{type:Object}},emits:["update:isInfoDrawerOpened","fetchApplications","formSubmitted"],setup(l,{emit:i}){const a=l;B();const{fetchUsers:s}=F();T();const{coreInfos:n}=v(B());v(F());const d=w(a.userApplicationDetails.inspection_id),D=w(null),C=()=>{i("update:isInfoDrawerOpened",!1),N(()=>{h()})},h=()=>{d.value=null,D.value=null,n.value=[]},S=()=>{let r={inspection_id:d.value,inspector_id:D.value};updateAppealApplication(a.userApplicationDetails.id,r).then(b=>{b.data.success&&(i("update:isInfoDrawerOpened",!1),i("fetchApplications"),N(()=>{h()}))})},U=r=>{i("update:isInfoDrawerOpened",r)},k=()=>{let r={filter:{inspection_id:d.value}};return s(r)};return P(d,async(r,b)=>{D.value=null,k()}),P(()=>a.userApplicationDetails,(r,b)=>{d.value=r.inspection_id}),(r,b)=>(g(),L("div",null,[e(ae,{permanent:"",width:700,location:"end",class:"scrollable-content","model-value":a.isInfoDrawerOpened,"onUpdate:modelValue":U},{default:t(()=>[o("div",se,[ie,e(X),e(V,{variant:"tonal",color:"error",icon:"",size:"32",class:"rounded",onClick:C},{default:t(()=>[e(R,{size:"18",icon:"tabler-x"})]),_:1})]),e(_(Q),{options:{wheelPropagation:!1}},{default:t(()=>[e(G,{flat:""},{default:t(()=>[e(H,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(f,null,{default:t(()=>[e(m,null,{default:t(()=>[o("h6",oe,[c(" id: "),o("span",le,u(a.userApplicationDetails.id),1)])]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(m,null,{default:t(()=>[o("h6",ne,[c(" Full name: "),o("span",re,u(a.userApplicationDetails.full_name),1)])]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(m,null,{default:t(()=>[o("h6",pe,[c(" Passport: "),o("span",ce,u(a.userApplicationDetails.passport_serial),1)])]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(m,null,{default:t(()=>[ue]),_:1}),o("p",null,[o("span",de,u(a.userApplicationDetails.appeal_text),1)])]),_:1}),e(f,null,{default:t(()=>[e(m,null,{default:t(()=>[fe]),_:1}),o("p",null,u(a.userApplicationDetails.inspection_name),1)]),_:1}),e(f,null,{default:t(()=>[e(m,null,{default:t(()=>[o("h6",me,[c(" Status: "),o("span",_e,[a.userApplicationDetails.status==="new"?(g(),x(y,{key:0,color:"success"},{default:t(()=>[c(u(a.userApplicationDetails.status),1)]),_:1})):O("",!0)])])]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(m,null,{default:t(()=>[o("h6",he,[c(" Document: "),o("span",null,[e(V,{icon:"tabler-download",size:"small"})])])]),_:1})]),_:1})]),_:1}),e(Z),e(ee,{class:"mt-4",onSubmit:J(S,["prevent"])},{default:t(()=>[e(te,null,{default:t(()=>[e(j,{cols:"12"}),e(j,{cols:"12",class:"d-flex gap-4"},{default:t(()=>[e(V,{type:"submit"},{default:t(()=>[c(" Submit ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])]))}},Be={__name:"list",setup(l){const i=w(!1),a=w({}),{userApplications:s,userApplication:n,loading:d,error:D,pagination:C}=v(T()),{fetchUserApplications:h}=T(),{fetchCoreInsInfos:S}=$(),{coreInsInfos:U}=v($()),k={title:"Appeal Applications",headers:["id","appeal_text","phone","type","status","actions"],filter:{title_uz:{model:"title_uz",type:"text",value:"Query"},status:{model:"status",type:"select",value:["Active","Inactive"]}}},r=w({filter:{parent_id:null}});h(r.value),S({getAll:!0});const b=()=>{h(r.value)},q=z=>{const I=s.value.data.filter(p=>p.id===z);a.value=I[0],i.value=!0},M=()=>{h(r.value)};return(z,I)=>(g(),L("section",null,[e(W,{onPageChanged:b,body:{data:_(s).data,pagination:_(C)},loading:_(d),tableData:k},{type:t(p=>[p.item.type?(g(),x(y,{key:0,color:"success"},{default:t(()=>[c(u(p.item.type),1)]),_:2},1024)):O("",!0)]),status:t(p=>[p.item.status==="new"?(g(),x(y,{key:0,color:"success"},{default:t(()=>[c(u(p.item.status),1)]),_:2},1024)):p.item.status==="processing"?(g(),x(y,{key:1,color:"warning"},{default:t(()=>[c(u(p.item.status),1)]),_:2},1024)):O("",!0)]),actions:t(p=>[e(V,{icon:"",onClick:ge=>q(p.item.id),size:"x-small",color:"default",variant:"text"},{default:t(()=>[e(R,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"])]),_:1},8,["body","loading"]),e(be,{onFetchApplications:M,userApplicationDetails:_(a),coreInspections:_(U),isInfoDrawerOpened:_(i),"onUpdate:isInfoDrawerOpened":I[0]||(I[0]=p=>K(i)?i.value=p:null)},null,8,["userApplicationDetails","coreInspections","isInfoDrawerOpened"])]))}};export{Be as default};
