import{k as m,aE as H,o as G,b as E,w as t,m as R,p as e,A as N,q as o,b4 as J,b1 as K,bh as W,b7 as T,bj as X,z as O,aP as j,bc as A,D as ne,c as me,a$ as pe}from"./index.ff6dd18a.js";import{_ as fe}from"./DataTable.8386c370.js";import{u as B}from"./libCategory.a99b8c58.js";import{u as P}from"./libCategoryGroup.a781bcc7.js";import{u as M}from"./coreLibraryTags.b8bd6454.js";import{r as c}from"./validators.03da0656.js";import{V as Y}from"./VSpacer.9cd97db6.js";import{V as C}from"./VBtn.05c82630.js";import{V as Z}from"./VForm.5de4a92d.js";import{V as z,a as s}from"./VRow.6a3eb9e0.js";import{V}from"./VTextField.afb07e72.js";import{V as k}from"./VSelect.cdb6d5f2.js";import{V as h}from"./VFileInput.12fbd56d.js";import{V as ee}from"./VSwitch.37089247.js";import{V as le}from"./VNavigationDrawer.64c65f66.js";import{_ as ye}from"./Confirmer.da69fa93.js";import{V as Q}from"./VChip.34758a01.js";import"./VDivider.709f44be.js";import"./axios.544a54a6.js";import"./form.03636cd0.js";import"./index.f6fb5e9e.js";import"./VInput.31ae3301.js";import"./VList.12bf040d.js";import"./dialog-transition.2a00a3c9.js";import"./VMenu.901c1049.js";import"./VCheckboxBtn.3329c02d.js";import"./VSelectionControl.82c875c1.js";import"./ssrBoot.051a63f0.js";import"./VDialog.ab1b1692.js";const be={class:"d-flex align-center pa-6 pb-1"},ge=R("h6",{class:"text-h6"}," Add Library Category ",-1),_e={__name:"FormCreate",props:{isCreateFormOpened:{default:null,required:!0},libGroups:{type:Object},coreTags:{type:Object}},emits:["update:isCreateFormOpened","formSubmitted"],setup($,{emit:b}){const i=$,g=m(!1),_=m(null),r=H({title_uz:"",title_en:"",title_ru:"",lib_category_group_id:"",coreCategory:{employer:[],employee:[]},status:1,order:"",image_file:[]}),d=()=>{b("update:isCreateFormOpened",!1),j(()=>{v()})},v=()=>{var p,a;(p=_.value)==null||p.reset(),r.title_uz="",r.title_en="",r.title_ru="",r.lib_category_group_id="",r.status=1,r.order="",r.image_file=[],r.coreCategory={employer:[],employee:[]},(a=_.value)==null||a.resetValidation()},x=()=>{var p;(p=_.value)==null||p.validate().then(({valid:a})=>{if(a){let l=new FormData;for(const u in r)u==="image_file"?l.append(u,r[u][0]):u==="coreCategory"?[...r.coreCategory.employee,...r.coreCategory.employer].forEach(U=>{l.append("core_library_tags[]",U)}):l.append(u,r[u]);b("formSubmitted",l),b("update:isCreateFormOpened",!1),j(()=>{v()})}})},w=p=>{b("update:isCreateFormOpened",p)};return(p,a)=>(G(),E(le,{permanent:"",width:1e3,location:"end",class:"scrollable-content","model-value":i.isCreateFormOpened,"onUpdate:modelValue":w},{default:t(()=>[R("div",be,[ge,e(Y),e(C,{variant:"tonal",color:"error",icon:"",size:"32",class:"rounded",onClick:d},{default:t(()=>[e(N,{size:"18",icon:"tabler-x"})]),_:1})]),e(o(J),{options:{wheelPropagation:!1}},{default:t(()=>[e(K,{flat:""},{default:t(()=>[e(W,null,{default:t(()=>[e(Z,{ref_key:"refLibCategoryCreateForm",ref:_,modelValue:o(g),"onUpdate:modelValue":a[9]||(a[9]=l=>T(g)?g.value=l:null),onSubmit:X(x,["prevent"])},{default:t(()=>[e(z,null,{default:t(()=>[e(s,{cols:"12"},{default:t(()=>[e(V,{modelValue:o(r).title_uz,"onUpdate:modelValue":a[0]||(a[0]=l=>o(r).title_uz=l),rules:[o(c)],label:"Title Uz"},null,8,["modelValue","rules"])]),_:1}),e(s,{cols:"12"},{default:t(()=>[e(V,{modelValue:o(r).title_ru,"onUpdate:modelValue":a[1]||(a[1]=l=>o(r).title_ru=l),rules:[o(c)],label:"Title Ru"},null,8,["modelValue","rules"])]),_:1}),e(s,{cols:"12"},{default:t(()=>[e(V,{modelValue:o(r).title_en,"onUpdate:modelValue":a[2]||(a[2]=l=>o(r).title_en=l),rules:[o(c)],label:"Title Ru"},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(z,{class:"mt-4"},{default:t(()=>[e(s,{cols:"6"},{default:t(()=>[e(k,{modelValue:o(r).lib_category_group_id,"onUpdate:modelValue":a[3]||(a[3]=l=>o(r).lib_category_group_id=l),items:i.libGroups.data,"item-value":"id","item-title":"title_uz",label:"Lib Category"},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"6"},{default:t(()=>[e(h,{label:"Image",modelValue:o(r).image_file,"onUpdate:modelValue":a[4]||(a[4]=l=>o(r).image_file=l),rules:[o(c)]},null,8,["modelValue","rules"])]),_:1}),e(s,{cols:"6"},{default:t(()=>[e(k,{modelValue:o(r).coreCategory.employer,"onUpdate:modelValue":a[5]||(a[5]=l=>o(r).coreCategory.employer=l),items:i.coreTags.employer,"item-title":"title_uz","item-value":"id",label:"Core Category Employer",multiple:""},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"6"},{default:t(()=>[e(k,{modelValue:o(r).coreCategory.employee,"onUpdate:modelValue":a[6]||(a[6]=l=>o(r).coreCategory.employee=l),items:i.coreTags.employee,"item-title":"title_uz","item-value":"id",label:"Core Category Employee",multiple:""},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"6"},{default:t(()=>[e(ee,{modelValue:o(r).status,"onUpdate:modelValue":a[7]||(a[7]=l=>o(r).status=l),label:"Status",value:1,color:"primary"},null,8,["modelValue"])]),_:1}),e(s,{cols:"6"},{default:t(()=>[e(V,{modelValue:o(r).order,"onUpdate:modelValue":a[8]||(a[8]=l=>o(r).order=l),rules:[o(c)],label:"Order",type:"number"},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(z,null,{default:t(()=>[e(s,{cols:"12"},{default:t(()=>[e(C,{type:"submit",class:"me-3",color:"success"},{default:t(()=>[O(" Submit ")]),_:1}),e(C,{variant:"tonal",color:"error",onClick:d},{default:t(()=>[O(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]))}},ce={class:"d-flex align-center pa-6 pb-1"},Ce=R("h6",{class:"text-h6"}," Update Library Category ",-1),Ve={__name:"FormUpdate",props:{isUpdateFormOpened:{default:null,required:!0},libCategory:{type:Object},libGroups:{type:Object},coreTags:{type:Object}},emits:["update:isUpdateFormOpened","formSubmitted"],setup($,{emit:b}){const i=$;A(B()),m([{id:null,title:null}]),m(null);const g=m(!1),_=m(null);m({filter:{parent_id:null}});const r=m([]),d=H({employer:[],employee:[]}),v=()=>{b("update:isUpdateFormOpened",!1),j(()=>{x()})},x=()=>{var a,l;(a=_.value)==null||a.reset(),i.libCategory.title_uz="",i.libCategory.title_en="",i.libCategory.title_ru="",i.libCategory.lib_category_group_id="",i.libCategory.core_library_tags={employer:[],employee:[]},i.libCategory.status=1,i.libCategory.order="",r.value=[],d.value={employer:[],employee:[]},(l=_.value)==null||l.resetValidation()},w=()=>{var a;(a=_.value)==null||a.validate().then(({valid:l})=>{if(l){let u=new FormData;for(const F in i.libCategory)F==="image_url"?r.value?u.append("image_file",r.value[0]):u.append("image_file",i.libCategory.image_url):F==="core_library_tags"?[...d.employee,...d.employer].forEach(S=>{u.append("core_library_tags[]",S)}):u.append(F,i.libCategory[F]);b("formSubmitted",u)}})},p=a=>{b("update:isUpdateFormOpened",a)};return ne(()=>i.libCategory.core_library_tags,()=>{d.employer=i.libCategory.core_library_tags.employer.map(a=>a.core_library_tag_id),d.employee=i.libCategory.core_library_tags.employee.map(a=>a.core_library_tag_id)}),(a,l)=>(G(),E(le,{permanent:"",width:1e3,location:"end",class:"scrollable-content","model-value":i.isUpdateFormOpened,"onUpdate:modelValue":p},{default:t(()=>[R("div",ce,[Ce,e(Y),e(C,{variant:"tonal",color:"error",icon:"",size:"32",class:"rounded",onClick:v},{default:t(()=>[e(N,{size:"18",icon:"tabler-x"})]),_:1})]),e(o(J),{options:{wheelPropagation:!1}},{default:t(()=>[e(K,{flat:""},{default:t(()=>[e(W,null,{default:t(()=>[e(Z,{ref_key:"refQuestionCreateForm",ref:_,modelValue:o(g),"onUpdate:modelValue":l[9]||(l[9]=u=>T(g)?g.value=u:null),onSubmit:X(w,["prevent"])},{default:t(()=>[e(z,null,{default:t(()=>[e(s,{cols:"12"},{default:t(()=>[e(V,{modelValue:i.libCategory.title_uz,"onUpdate:modelValue":l[0]||(l[0]=u=>i.libCategory.title_uz=u),rules:[o(c)],label:"Title Uz"},null,8,["modelValue","rules"])]),_:1}),e(s,{cols:"12"},{default:t(()=>[e(V,{modelValue:i.libCategory.title_ru,"onUpdate:modelValue":l[1]||(l[1]=u=>i.libCategory.title_ru=u),rules:[o(c)],label:"Title Ru"},null,8,["modelValue","rules"])]),_:1}),e(s,{cols:"12"},{default:t(()=>[e(V,{modelValue:i.libCategory.title_en,"onUpdate:modelValue":l[2]||(l[2]=u=>i.libCategory.title_en=u),rules:[o(c)],label:"Title Ru"},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(z,{class:"mt-4"},{default:t(()=>[e(s,{cols:"6"},{default:t(()=>[e(k,{modelValue:i.libCategory.lib_category_group_id,"onUpdate:modelValue":l[3]||(l[3]=u=>i.libCategory.lib_category_group_id=u),items:i.libGroups.data,"item-value":"id","item-title":"title_uz",label:"Lib Category"},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"6"},{default:t(()=>[e(h,{label:"Image",modelValue:o(r),"onUpdate:modelValue":l[4]||(l[4]=u=>T(r)?r.value=u:null)},null,8,["modelValue"])]),_:1}),e(s,{cols:"6"},{default:t(()=>[e(k,{modelValue:o(d).employer,"onUpdate:modelValue":l[5]||(l[5]=u=>o(d).employer=u),items:i.coreTags.employer,"item-title":"title_uz","item-value":"id",label:"Core Category Employer",multiple:""},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"6"},{default:t(()=>[e(k,{modelValue:o(d).employee,"onUpdate:modelValue":l[6]||(l[6]=u=>o(d).employee=u),items:i.coreTags.employee,"item-title":"title_uz","item-value":"id",label:"Core Category Employee",multiple:""},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"6"},{default:t(()=>[e(ee,{modelValue:i.libCategory.status,"onUpdate:modelValue":l[7]||(l[7]=u=>i.libCategory.status=u),label:"Status",value:1,color:"primary"},null,8,["modelValue"])]),_:1}),e(s,{cols:"6"},{default:t(()=>[e(V,{modelValue:i.libCategory.order,"onUpdate:modelValue":l[8]||(l[8]=u=>i.libCategory.order=u),rules:[o(c)],label:"Order"},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(z,null,{default:t(()=>[e(s,{cols:"12"},{default:t(()=>[e(C,{type:"submit",class:"me-3",color:"success"},{default:t(()=>[O(" Submit ")]),_:1}),e(C,{variant:"tonal",color:"error",onClick:v},{default:t(()=>[O(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]))}},Xe={__name:"list",setup($){const{libCategories:b,libCategory:i,loading:g,error:_,pagination:r}=A(B()),{fetchLibCategories:d,addLibCategory:v,fetchLibCategory:x,updateLibCategory:w,deleteLibCategory:p}=B(),{libGroups:a}=A(P()),{fetchLibGroups:l}=P();A(M());const{fetchCoreTags:u}=M(),F={title:"Lib Category",headers:["id","title_uz","title_en","title_ru","status","actions"],filter:{title_uz:{model:"title_uz",type:"text",value:"Query"},status:{model:"status",type:"select",value:["Active","Inactive"]}}},U=m(!1),S=m(!1),L=m(!1),q=m(null),D=m({filter:{parent_id:null}}),I=m({});d(D.value),l({getAll:!0}),u({getAll:!0,type_of_use:"employer"}).then(n=>{I.value.employer=n.data.result.data}),u({getAll:!0,type_of_use:"employee"}).then(n=>{I.value.employee=n.data.result.data});const te=()=>{d(D.value)},oe=()=>{p(q.value).then(n=>{L.value=!1,d(D.value)})},ae=n=>{L.value=!0,q.value=n},re=n=>{U.value=n.isCreateFormOpened},ie=n=>{x(n.libCategoryId).then(y=>{S.value=n.isUpdateFormOpened})},ue=n=>{v(n).then(y=>{d(D.value)})},se=n=>{w(i.value.id,n).then(y=>{d(D.value)})};return(n,y)=>(G(),me("section",null,[e(fe,{onPageChanged:te,body:{data:o(b).data,pagination:o(r)},loading:o(g),tableData:F},{pageActions:t(()=>[e(z,null,{default:t(()=>[e(s,{cols:"2",offset:"md-10"},{default:t(()=>[e(C,{"prepend-icon":"tabler-plus",onClick:y[0]||(y[0]=f=>re({isCreateFormOpened:!0}))},{default:t(()=>[O(" Create ")]),_:1})]),_:1})]),_:1})]),status:t(f=>[f.item.status===1?(G(),E(Q,{key:0,color:"success"},{default:t(()=>[O(" Active ")]),_:1})):f.item.status===0?(G(),E(Q,{key:1,color:"error"},{default:t(()=>[O(" Inactive ")]),_:1})):pe("",!0)]),actions:t(f=>[e(C,{onClick:de=>ie({isUpdateFormOpened:!0,libCategoryId:f.item.id}),icon:"",size:"x-small",color:"default",variant:"text"},{default:t(()=>[e(N,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(C,{icon:"",onClick:de=>ae(f.item.id),size:"x-small",color:"default",variant:"text"},{default:t(()=>[e(N,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])]),_:1},8,["body","loading"]),e(_e,{onFormSubmitted:ue,isCreateFormOpened:o(U),"onUpdate:isCreateFormOpened":y[1]||(y[1]=f=>T(U)?U.value=f:null),libGroups:o(a),coreTags:o(I)},null,8,["isCreateFormOpened","libGroups","coreTags"]),e(Ve,{onFormSubmitted:se,libCategory:o(i),isUpdateFormOpened:o(S),"onUpdate:isUpdateFormOpened":y[2]||(y[2]=f=>T(S)?S.value=f:null),libGroups:o(a),coreTags:o(I)},null,8,["libCategory","isUpdateFormOpened","libGroups","coreTags"]),e(ye,{isOpen:o(L),"onUpdate:isOpen":y[3]||(y[3]=f=>T(L)?L.value=f:null),loading:o(g),onAccepted:oe},null,8,["isOpen","loading"])]))}};export{Xe as default};
