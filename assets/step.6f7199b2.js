import{a3 as ne,a4 as se,a5 as ie,a6 as ue,a7 as re,a8 as de,a9 as O,k as v,K as ce,ad as me,p as e,a2 as L,af as ve,ag as fe,bc as _e,o as r,c as C,w as t,b1 as P,q as l,F as $,bh as w,m as b,b as p,z as I,a$ as R,b7 as B,a as j,x as A,b2 as pe,bO as Ve,j as ge}from"./index.ff6dd18a.js";import{u as M}from"./scenarioStore.d1c01f58.js";import{a as m,V as k}from"./VRow.6a3eb9e0.js";import{V as N}from"./VBtn.05c82630.js";import{b as xe,c as Y,V as be,a as J}from"./VTabs.aa32f21b.js";import{V as H}from"./VDivider.709f44be.js";import{V as ye}from"./VCheckbox.2240e4e6.js";import{V as he,a as qe}from"./VRadioGroup.3bf75417.js";import{V as X}from"./VSwitch.37089247.js";import{V as ke}from"./VForm.5de4a92d.js";import{V as Se}from"./VSelect.cdb6d5f2.js";import"./axios.544a54a6.js";import"./ssrBoot.051a63f0.js";import"./index.f6fb5e9e.js";import"./VInput.31ae3301.js";import"./form.03636cd0.js";import"./VCheckboxBtn.3329c02d.js";import"./VSelectionControl.82c875c1.js";import"./VTextField.afb07e72.js";import"./VList.12bf040d.js";import"./dialog-transition.2a00a3c9.js";import"./VMenu.901c1049.js";import"./VChip.34758a01.js";const Ce=ne()({name:"VTooltip",props:{id:String,text:String,...se(ie({closeOnBack:!1,location:"end",locationStrategy:"connected",minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent","eager"])},emits:{"update:modelValue":n=>!0},setup(n,Q){let{slots:T}=Q;const U=ue(n,"modelValue"),{scopeId:D}=re(),F=de(),o=O(()=>n.id||`v-tooltip-${F}`),V=v(),i=O(()=>n.location.split(" ").length>1?n.location:n.location+" center"),z=O(()=>n.origin==="auto"||n.origin==="overlap"||n.origin.split(" ").length>1||n.location.split(" ").length>1?n.origin:n.origin+" center"),f=O(()=>n.transition?n.transition:U.value?"scale-transition":"fade-transition");return ce(()=>{const[_]=me(n);return e(ve,L({ref:V,class:["v-tooltip"],id:o.value},_,{modelValue:U.value,"onUpdate:modelValue":d=>U.value=d,transition:f.value,absolute:!0,location:i.value,origin:z.value,persistent:!0,role:"tooltip",eager:!0,activatorProps:L({"aria-describedby":o.value},n.activatorProps)},D),{activator:T.activator,default:function(){var S;for(var d,y=arguments.length,h=new Array(y),g=0;g<y;g++)h[g]=arguments[g];return(S=(d=T.default)==null?void 0:d.call(T,...h))!=null?S:n.text}})}),fe({},V)}}),we={class:"d-flex align-center justify-end"},Ie={class:"misc-wrapper"},Te={class:"misc-center-content text-center mr-6"},Ue={class:"d-flex justify-space-between"},$e={class:"font-weight-semibold me-3"},Re={class:"d-flex flex-row-reverse mb-6"},Ae={class:"d-flex justify-end"},at={__name:"step",setup(n){const Q=Ve(),T=ge(),{getStepQuestions:U,getQuestionDetails:D,saveScenarios:F}=M(),{step:o,scenarios:V,scenario:i,loading:z}=_e(M()),f={category_id:Q.params.category,step:Q.params.step},_=v(0),d=v([]);v(null);const y=v(!1),h=v([]),g=v([]),S=v(null),W=v(!1),q=v("");U(f).then(s=>{_.value=0,o.value.questions.map(a=>{a.is_disabled=!1})});const Z=s=>{f.question_id=s,S.value=s,d.value=[],i.value.question_id=null,y.value=!1,D(f).then(a=>{h.value=o.value.selected_question_ids,g.value=o.value.next_questions,G()})},K=s=>{s==="checkbox"?q.value=d.value.sort().toString():q.value=d.value.toString(),y.value=!o.value.scenarioIndexes.includes(q.value)&&q.value!==""},ee=()=>{o.value.scenarioIndexes.includes(q.value)||(i.value.scenario_index=q.value,o.value.scenarioIndexes.push(q.value),V.value.push({name:i.value.name,question_id:i.value.question_id,scenario_index:i.value.scenario_index,parent_question_id:S,order:parseInt(f.step)+1}),h.value.push(i.value.question_id),y.value=!1,i.value.question_id=null,E(!0),W.value=!0,G())},E=s=>{W.value=s,o.value.questions.map(a=>{a.question_id!==S.value&&(a.is_disabled=s)})},te=s=>{const a=V.value.findIndex(u=>u.scenario_index===s);h.value.splice(i.value.question_id,1),V.value.splice(a,1),o.value.scenarioIndexes.splice(i.value.scenario_index,1),E(!0),G()},le=s=>o.value.next_questions.filter(a=>a.id===s)[0],G=()=>{g.value=o.value.next_questions.filter(s=>!h.value.includes(s.id))},ae=()=>{F(f,{next:V.value}).then(s=>{E(!1)})},oe=(s=!1)=>{T.push({path:`/assessment/category/${f.category_id}/scenario/list`})};return(s,a)=>(r(),C("section",null,[e(k,null,{default:t(()=>[e(m,{cols:"12"},{default:t(()=>[e(P,{title:`Step ${f.step}`,loading:l(z)},{default:t(()=>[l(z)?R("",!0):(r(),C($,{key:0},[e(w,null,{default:t(()=>[b("div",we,[b("div",Ie,[b("div",Te,[l(W)?R("",!0):(r(),p(N,{key:0,class:"ma-2 h-4",color:"success",onClick:oe},{default:t(()=>[I(" Yakunlash ")]),_:1}))])])])]),_:1}),e(w,null,{default:t(()=>[e(k,null,{default:t(()=>[e(m,{cols:"3"},{default:t(()=>[e(xe,{modelValue:l(_),"onUpdate:modelValue":a[0]||(a[0]=u=>B(_)?_.value=u:null),direction:"vertical"},{default:t(()=>[e(Y,{key:"0",value:"0",hidden:""}),(r(!0),C($,null,j(l(o).questions,u=>(r(),p(Y,{key:u.question_id,value:u.question_id,disabled:u.is_disabled,onClick:c=>Z(u.question_id)},{default:t(()=>[I(A(u.question_title_uz)+" ",1),e(Ce,{activator:"parent",location:"bottom"},{default:t(()=>[I(A(u.question_title_uz),1)]),_:2},1024)]),_:2},1032,["value","disabled","onClick"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(H,{vertical:""}),e(m,{cols:"9"},{default:t(()=>[e(be,{modelValue:l(_),"onUpdate:modelValue":a[5]||(a[5]=u=>B(_)?_.value=u:null)},{default:t(()=>[e(J,{hidden:"",key:"0",value:"0"}),(r(!0),C($,null,j(l(o).questions,u=>(r(),p(J,{key:u.question_id,value:u.question_id},{default:t(()=>[e(P,{variant:"tonal"},{default:t(()=>[e(w,null,{default:t(()=>[e(k,{class:"mb-1",justify:"space-between",align:"stretch","align-content":"space-between"},{default:t(()=>[e(m,null,{default:t(()=>[b("div",Ue,[b("h2",$e,A(l(o).question.title_uz),1)])]),_:2},1024),e(m,{cols:"6"},{default:t(()=>[b("div",Re,[e(N,{class:"ma-2 h-4",color:"primary",onClick:ae},{default:t(()=>[I(" Saqlash ")]),_:1})])]),_:1})]),_:2},1024),e(H),e(k,{class:"my-4"},{default:t(()=>[e(m,{cols:"5"},{default:t(()=>[(r(!0),C($,null,j(l(o).question.answers,c=>(r(),p(k,null,{default:t(()=>[e(m,{cols:"1"},{default:t(()=>[l(o).question.type==="checkbox"?(r(),p(ye,{key:0,onChange:x=>K(l(o).question.type),modelValue:l(d),"onUpdate:modelValue":a[1]||(a[1]=x=>B(d)?d.value=x:null),value:c.id,class:"mb-2"},null,8,["onChange","modelValue","value"])):l(o).question.type==="radio"?(r(),p(he,{key:1,modelValue:l(d),"onUpdate:modelValue":a[2]||(a[2]=x=>B(d)?d.value=x:null)},{default:t(()=>[e(qe,{onChange:x=>K(l(o).question.type),value:c.id},null,8,["onChange","value"])]),_:2},1032,["modelValue"])):R("",!0)]),_:2},1024),e(m,null,{default:t(()=>[b("p",null,A(c.title_en),1)]),_:2},1024)]),_:2},1024))),256))]),_:2},1024),e(m,null,{default:t(()=>[l(y)?(r(),p(P,{key:0,title:"Select question"},{append:t(()=>[e(X,{modelValue:l(i).name,"onUpdate:modelValue":a[3]||(a[3]=c=>l(i).name=c),label:"end",value:"end",color:"error"},null,8,["modelValue"])]),default:t(()=>[e(w,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(Se,{density:"comfortable",modelValue:l(i).question_id,"onUpdate:modelValue":a[4]||(a[4]=c=>l(i).question_id=c),items:l(g),"item-title":"title_uz","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(k,{class:"mt-4"},{default:t(()=>[e(m,null,{default:t(()=>[l(i).question_id!==null?(r(),p(N,{key:0,color:"primary",onClick:ee},{default:t(()=>[I(" Add ")]),_:1})):R("",!0)]),_:1})]),_:1})]),_:1})]),_:1})):R("",!0)]),_:1})]),_:2},1024),e(H),e(k,{class:"mt-4"},{default:t(()=>[(r(!0),C($,null,j(l(V),c=>(r(),p(m,{cols:"4"},{default:t(()=>[e(P,{title:c.scenario_index},{append:t(()=>[e(X,{label:"end",modelValue:c.name,"onUpdate:modelValue":x=>c.name=x,value:"end",color:"error"},null,8,["modelValue","onUpdate:modelValue"])]),default:t(()=>[e(w,null,{default:t(()=>[I(A(le(c.question_id).title_uz),1)]),_:2},1024),e(pe,null,{default:t(()=>[e(w,null,{default:t(()=>[b("div",Ae,[e(N,{onClick:x=>te(c.scenario_index),icon:"mdi-delete",size:"small",color:"error"},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title"])]),_:2},1024))),256))]),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})],64))]),_:1},8,["title","loading"])]),_:1})]),_:1})]))}};export{at as default};
