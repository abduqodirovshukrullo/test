import{k as f,D as $,o as S,b as J,w as s,p as o,b1 as M,bh as h,G as W,q as t,m as p,A as z,c as A,a$ as K,bj as j,b7 as D,z as R,bc as B,F as H,a as Q,x as X,bs as G,bO as Y,r as Z}from"./index.ccf75e8b.js";import{r as m}from"./validators.03da0656.js";import{a as r,V as O}from"./VRow.126a71fb.js";import{V as v}from"./VBtn.51511430.js";import{V as ee}from"./VDivider.82c53423.js";import{V as oe}from"./VForm.39e46bcf.js";import{V as b}from"./VTextField.3149a27e.js";import{V as U}from"./VTextarea.8568297e.js";import{u as P}from"./systemUserStore.da0c3aeb.js";import{u as q}from"./coreInspectorInfos.343b3646.js";import{c as le,b as ae,a as E,V as se}from"./VTabs.c2c6dbcd.js";import"./form.66042bc2.js";import"./index.d79d6c26.js";import"./VInput.eb4ac968.js";import"./axios.6988005b.js";import"./ssrBoot.9c630877.js";const w="/assets/default-profile.931c3354.png",te={class:"d-flex flex-column justify-center gap-4"},ne={class:"d-flex flex-wrap gap-2"},re=p("span",{class:"d-none d-sm-block"},"Upload new photo",-1),ue=p("span",{class:"d-none d-sm-block"},"Reset",-1),ie={key:0,class:"text-body-1 mb-0",style:{color:"rgba(255,27,0,0.75)"}},me=p("p",{class:"text-body-1 mb-0"}," Allowed JPG, GIF or PNG. Max size of 800K ",-1),fe={__name:"AccountSettingsAccount",props:{user:{type:Object,default:{}},inspectorInfo:{type:Object,default:{}}},emits:["formSubmitted"],setup(N,{emit:k}){const e=N,x=f(null),d=f([]),I=f(!1),_=f("");f(!1);const c=f({image:w});f(!1);const y=()=>{c.value.image=w},C=n=>{const l=new FileReader,{files:a}=n.target;a&&a.length&&(l.readAsDataURL(a[0]),e.inspectorInfo.image_file=a[0],I.value=!1,l.onload=()=>{typeof l.result=="string"&&(c.value.image=l.result)})},T=()=>{c.value.image=w},F=()=>{var n;if(!e.inspectorInfo.image_file&&!e.inspectorInfo.image_url.length>0){I.value=!0;return}(n=x.value)==null||n.validate().then(({valid:l})=>{if(l){let a=new FormData;for(const u in e.inspectorInfo)a.append(u,e.inspectorInfo[u]);k("formSubmitted",a)}})},V=()=>e.user.user_info.first_name+" "+e.user.user_info.sur_name+" "+e.user.user_info.patronymic;return $(()=>e.user,()=>{if(e.user.inspector){for(const n in e.user.inspector)e.inspectorInfo[n]=e.user.inspector[n];c.value.image=e.user.inspector.image_url}else e.inspectorInfo.fullname_uz=e.inspectorInfo.fullname_uz?e.inspectorInfo.fullname_uz:V(),e.inspectorInfo.fullname_ru=e.inspectorInfo.fullname_ru?e.inspectorInfo.fullname_ru:V(),e.inspectorInfo.fullname_en=e.inspectorInfo.fullname_en?e.inspectorInfo.fullname_en:V(),e.inspectorInfo.user_id=e.user.id;_.value=e.user.user_company.info.name_uz}),(n,l)=>(S(),J(O,null,{default:s(()=>[o(r,{cols:"12"},{default:s(()=>[o(M,{title:"Profile Details"},{default:s(()=>[o(h,{class:"d-flex"},{default:s(()=>[o(W,{rounded:"",size:"100",class:"me-6",image:t(c).image},null,8,["image"]),p("form",te,[p("div",ne,[o(v,{color:"primary",onClick:l[0]||(l[0]=a=>{var u;return(u=t(d))==null?void 0:u.click()})},{default:s(()=>[o(z,{icon:"tabler-cloud-upload",class:"d-sm-none"}),re]),_:1}),p("input",{ref_key:"image_file",ref:d,type:"file",name:"file",accept:".jpeg,.png,.jpg,GIF",hidden:"",onInput:C,required:""},null,544),o(v,{type:"reset",color:"secondary",variant:"tonal",onClick:T},{default:s(()=>[ue,o(z,{icon:"tabler-refresh",class:"d-sm-none"})]),_:1})]),t(I)?(S(),A("p",ie," Iltimos profile uchun rasm yuklang! ")):K("",!0),me])]),_:1}),o(ee),o(h,{class:"pt-2"},{default:s(()=>[o(oe,{class:"mt-6",ref_key:"refcoreInfoCreateForm",ref:x,onSubmit:j(F,["prevent"])},{default:s(()=>[o(O,null,{default:s(()=>[o(r,{md:"12",cols:"12"},{default:s(()=>[o(b,{modelValue:e.inspectorInfo.fullname_uz,"onUpdate:modelValue":l[1]||(l[1]=a=>e.inspectorInfo.fullname_uz=a),label:"Full Name Uz",rules:[t(m)]},null,8,["modelValue","rules"])]),_:1}),o(r,{md:"12",cols:"12"},{default:s(()=>[o(b,{modelValue:e.inspectorInfo.fullname_ru,"onUpdate:modelValue":l[2]||(l[2]=a=>e.inspectorInfo.fullname_ru=a),label:"Full Name Ru",rules:[t(m)]},null,8,["modelValue","rules"])]),_:1}),o(r,{md:"12",cols:"12"},{default:s(()=>[o(b,{modelValue:e.inspectorInfo.fullname_en,"onUpdate:modelValue":l[3]||(l[3]=a=>e.inspectorInfo.fullname_en=a),label:"Full Name En",rules:[t(m)]},null,8,["modelValue","rules"])]),_:1}),o(r,{cols:"12",md:"6"},{default:s(()=>[o(b,{modelValue:e.inspectorInfo.phone,"onUpdate:modelValue":l[4]||(l[4]=a=>e.inspectorInfo.phone=a),label:"Phone Number",rules:[t(m)]},null,8,["modelValue","rules"])]),_:1}),o(r,{md:"6",cols:"12"},{default:s(()=>[o(b,{modelValue:t(_),"onUpdate:modelValue":l[5]||(l[5]=a=>D(_)?_.value=a:null),label:"Company",rules:[t(m)],disabled:""},null,8,["modelValue","rules"])]),_:1}),o(r,{md:"4",cols:"12"},{default:s(()=>[o(U,{modelValue:e.inspectorInfo.admission_days_uz,"onUpdate:modelValue":l[6]||(l[6]=a=>e.inspectorInfo.admission_days_uz=a),label:"Admission Days Uz",rules:[t(m)]},null,8,["modelValue","rules"])]),_:1}),o(r,{md:"4",cols:"12"},{default:s(()=>[o(U,{modelValue:e.inspectorInfo.admission_days_ru,"onUpdate:modelValue":l[7]||(l[7]=a=>e.inspectorInfo.admission_days_ru=a),label:"Admission Days Ru",rules:[t(m)]},null,8,["modelValue","rules"])]),_:1}),o(r,{md:"4",cols:"12"},{default:s(()=>[o(U,{modelValue:e.inspectorInfo.admission_days_en,"onUpdate:modelValue":l[8]||(l[8]=a=>e.inspectorInfo.admission_days_en=a),label:"Admission Days En",rules:[t(m)]},null,8,["modelValue","rules"])]),_:1}),o(r,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:s(()=>[o(v,{type:"submit"},{default:s(()=>[R(" Save changes ")]),_:1}),o(v,{color:"secondary",variant:"tonal",type:"reset",onClick:j(y,["prevent"])},{default:s(()=>[R(" Reset ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1}))}},de={__name:"[tab]",setup(N){const k=Y(),e=f(k.params.tab),{users:x,user:d,loading:I,error:_,pagination:c}=B(P()),{fetchUserShow:y}=P(),{coreInfo:C}=B(q()),{fetchCoreInfo:T,addCoreInfo:F,updateCoreInfo:V}=q(),n=JSON.parse(localStorage.getItem("userData"));y(n.id);const l=u=>{d.value.inspector?V(d.value.inspector.id,u):F(u),y(n.id)},a=[{title:"Account",icon:"tabler-users",tab:"account"}];return(u,g)=>{const L=Z("AccountSettingsSecurity");return S(),A("div",null,[o(ae,{modelValue:t(e),"onUpdate:modelValue":g[0]||(g[0]=i=>D(e)?e.value=i:null),class:"v-tabs-pill"},{default:s(()=>[(S(),A(H,null,Q(a,i=>o(le,{key:i.icon,value:i.tab,to:{name:"user-account-tab",params:{tab:i.tab}}},{default:s(()=>[o(z,{size:"20",start:"",icon:i.icon},null,8,["icon"]),R(" "+X(i.title),1)]),_:2},1032,["value","to"])),64))]),_:1},8,["modelValue"]),o(se,{modelValue:t(e),"onUpdate:modelValue":g[1]||(g[1]=i=>D(e)?e.value=i:null),class:"mt-6 disable-tab-transition",touch:!1},{default:s(()=>[o(E,{value:"account"},{default:s(()=>[o(fe,{onFormSubmitted:l,user:t(d),inspectorInfo:t(C)},null,8,["user","inspectorInfo"])]),_:1}),o(E,{value:"security"},{default:s(()=>[o(L)]),_:1})]),_:1},8,["modelValue"])])}}};typeof G=="function"&&G(de);export{de as default};
