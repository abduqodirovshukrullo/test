import{m as Z}from"./VSelect.e2438bf0.js";import{ah as q,a9 as K,q as ee,aH as H,aB as te,a3 as le,a4 as ae,P as ne,U as ue,k as x,a6 as j,D as B,aP as N,K as oe,p as r,F as Q,a2 as O,ae as se,z as ie,ag as re,bb as $}from"./main.28eac655.js";import{u as ce,V as fe,a as z}from"./VList.2e46a22e.js";import{m as de,f as ve,V as me}from"./VTextField.b8935754.js";import{V as he}from"./VMenu.cc85e129.js";import{V as pe}from"./VCheckboxBtn.f5856159.js";import{V as ge}from"./VChip.15e3c72f.js";import{a as G}from"./axios.8204d459.js";const ye=(e,a,t)=>e==null||a==null?-1:e.toString().toLocaleLowerCase().indexOf(a.toString().toLocaleLowerCase()),Ve=q({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function ke(e,a,t){var p,F;const u=[],y=(p=t==null?void 0:t.default)!=null?p:ye,v=t!=null&&t.filterKeys?H(t.filterKeys):!1,m=Object.keys((F=t==null?void 0:t.customKeyFilter)!=null?F:{}).length;if(!(e!=null&&e.length))return u;e:for(let C=0;C<e.length;C++){const n=e[C],c={},g={};let f=-1;if(a&&!(t!=null&&t.noFilter)){if(typeof n=="object"){const T=v||Object.keys(n);for(const k of T){var i;const M=te(n,k,n),P=t==null||(i=t.customKeyFilter)==null?void 0:i[k];if(f=P?P(M,a,n):y(M,a,n),f!==-1&&f!==!1)P?c[k]=f:g[k]=f;else if((t==null?void 0:t.filterMode)==="every")continue e}}else f=y(n,a,n),f!==-1&&f!==!1&&(g.title=f);const I=Object.keys(g).length,V=Object.keys(c).length;if(!I&&!V||(t==null?void 0:t.filterMode)==="union"&&V!==m&&!I||(t==null?void 0:t.filterMode)==="intersection"&&(V!==m||!I))continue}u.push({index:C,matches:{...g,...c}})}return u}function Fe(e,a,t){const u=K(()=>typeof(t==null?void 0:t.value)!="string"&&typeof(t==null?void 0:t.value)!="number"?"":String(t.value));return{filteredItems:K(()=>{const v=ee(a);return ke(v,u.value,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}).map(i=>{let{index:p,matches:F}=i;return{item:v[p],matches:F}})})}}function Ce(e,a,t){if(Array.isArray(a))throw new Error("Multiple matches is not implemented");return typeof a=="number"&&~a?r(Q,null,[r("span",{class:"v-autocomplete__unmask"},[e.substr(0,a)]),r("span",{class:"v-autocomplete__mask"},[e.substr(a,t)]),r("span",{class:"v-autocomplete__unmask"},[e.substr(a+t)])]):e}const _e=le()({name:"VAutocomplete",props:{search:String,...Ve({filterKeys:["title"]}),...Z(),...ae(de({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...ne({transition:!1})},emits:{"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,a){let{slots:t}=a;const{t:u}=ue(),y=x(),v=x(!1),m=x(!0),i=j(e,"menu"),{items:p,transformIn:F,transformOut:C}=ce(e),n=j(e,"search",""),c=j(e,"modelValue",[],l=>F(H(l)),l=>{var s;const o=C(l);return e.multiple?o:(s=o[0])!=null?s:null}),{filteredItems:g}=Fe(e,p,K(()=>m.value?void 0:n.value)),f=K(()=>c.value.map(l=>p.value.find(o=>o.value===l.value)||l)),I=K(()=>f.value.map(l=>l.props.value)),V=x();function T(l){c.value=[],e.openOnClear&&(i.value=!0),n.value=""}function k(){e.hideNoData&&!p.value.length||e.readonly||(i.value=!0)}function M(l){if(!e.readonly){if(["Enter","ArrowDown"].includes(l.key)&&(i.value=!0),["Escape"].includes(l.key)&&(i.value=!1),["Enter","Escape","Tab"].includes(l.key)&&(m.value=!0),l.key==="ArrowDown"){var o;l.preventDefault(),(o=V.value)==null||o.focus("next")}else if(l.key==="ArrowUp"){var s;l.preventDefault(),(s=V.value)==null||s.focus("prev")}}}function P(l){n.value=l.target.value}function J(){v.value&&(m.value=!0)}function W(l){v.value=!0}function X(l){if(l.relatedTarget==null){var o;(o=y.value)==null||o.focus()}}const b=x(!1);function _(l){if(e.multiple){const o=I.value.findIndex(s=>s===l.value);if(o===-1)c.value=[...c.value,l],n.value="";else{const s=[...c.value];s.splice(o,1),c.value=s}}else c.value=[l],b.value=!0,t.selection||(n.value=l.title),i.value=!1,m.value=!0,N(()=>b.value=!1)}return B(v,l=>{var s;if(l){var o;b.value=!0,n.value=e.multiple||!!t.selection?"":String((s=(o=f.value.at(-1))==null?void 0:o.props.title)!=null?s:""),m.value=!0,N(()=>b.value=!1)}else i.value=!1,n.value=""}),B(n,l=>{!v.value||b.value||(l&&(i.value=!0),m.value=!l)}),oe(()=>{const l=!!(e.chips||t.chip),[o]=ve(e);return r(me,O({ref:y},o,{modelValue:n.value,"onUpdate:modelValue":s=>{s==null&&(c.value=[])},validationValue:c.externalValue,dirty:c.value.length>0,onInput:P,class:["v-autocomplete",{"v-autocomplete--active-menu":i.value,"v-autocomplete--chips":!!e.chips,[`v-autocomplete--${e.multiple?"multiple":"single"}`]:!0,"v-autocomplete--selection-slot":!!t.selection}],appendInnerIcon:e.menuIcon,readonly:e.readonly,"onClick:clear":T,"onClick:control":k,"onClick:input":k,onFocus:()=>v.value=!0,onBlur:()=>v.value=!1,onKeydown:M}),{...t,default:()=>{var s,E,R;return r(Q,null,[r(he,O({modelValue:i.value,"onUpdate:modelValue":d=>i.value=d,activator:"parent",contentClass:"v-autocomplete__content",eager:e.eager,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:J},e.menuProps),{default:()=>[r(fe,{ref:V,selected:I.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:d=>d.preventDefault(),onFocusin:W,onFocusout:X},{default:()=>{var d;return[!g.value.length&&!e.hideNoData&&((d=(s=t["no-data"])==null?void 0:s.call(t))!=null?d:r(z,{title:u(e.noDataText)},null)),(E=t["prepend-item"])==null?void 0:E.call(t),g.value.map((w,A)=>{var U;var S;let{item:h,matches:Y}=w;return(U=(S=t.item)==null?void 0:S.call(t,{item:h,index:A,props:O(h.props,{onClick:()=>_(h)})}))!=null?U:r(z,O({key:A},h.props,{onClick:()=>_(h)}),{prepend:D=>{let{isSelected:L}=D;return e.multiple&&!e.hideSelected?r(pe,{modelValue:L,ripple:!1},null):void 0},title:()=>{var L;var D;return m.value?h.title:Ce(h.title,Y.title,(L=(D=n.value)==null?void 0:D.length)!=null?L:0)}})}),(R=t["append-item"])==null?void 0:R.call(t)]}})]}),f.value.map((d,w)=>{function A(h){h.stopPropagation(),h.preventDefault(),_(d)}const S={"onClick:close":A,modelValue:!0,"onUpdate:modelValue":void 0};return r("div",{key:d.value,class:"v-autocomplete__selection"},[l?r(se,{defaults:{VChip:{closable:e.closableChips,size:"small",text:d.title}}},{default:()=>[t.chip?t.chip({item:d,index:w,props:S}):r(ge,S,null)]}):t.selection?t.selection({item:d,index:w}):r("span",{class:"v-autocomplete__selection-text"},[d.title,e.multiple&&w<f.value.length-1&&r("span",{class:"v-autocomplete__selection-comma"},[ie(",")])])])})])}})}),re({isFocused:v,isPristine:m,menu:i,search:n,filteredItems:g,select:_},y)}}),Ae=$("Regions",{state:()=>({regions:[]}),actions:{fetchRegions(e){return this.loading=!0,new Promise((a,t)=>{G.get("/resource-region").then(u=>{this.regions=u.data.data,a(u)}).catch(u=>{this.error=u,t(u)}).finally(()=>{this.loading=!1})})}}}),De=$("Cities",{state:()=>({cities:[]}),actions:{fetchCities(e){return this.loading=!0,e={...e},new Promise((a,t)=>{G.get("/resource-city",{params:e}).then(u=>{this.cities=u.data.data,a(u)}).catch(u=>{this.error=u,t(u)}).finally(()=>{this.loading=!1})})}}});export{_e as V,De as a,Ae as u};
